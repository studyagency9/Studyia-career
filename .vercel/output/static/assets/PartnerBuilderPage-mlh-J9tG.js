import{j as e,X as a,m as t,e as s,z as r}from"./ui-vendor-CNk_zvnd.js";import{r as o,f as i,u as n,e as d}from"./react-vendor-BjqsZnKR.js";import{h as l,b as c,c as m,a as p,B as u}from"./index-CcJ1OsnK.js";import{P as f}from"./PartnerLayout-CyuO4Ior.js";import h from"./BuilderPage-shR9kx2a.js";import{I as x}from"./input-C_QA9aJK.js";import{L as g}from"./label-CrkOYzeR.js";import{R as j,P as v,C as b,a as N,T as y,D as w,O as C}from"./pdfGenerator-CFDpQBLd.js";import"./LanguageSwitcher-4nTyKiJX.js";import"./index-D3__vsal.js";import"./tslib.es6-JUDyx5pz.js";import"./useSEO-Dyc3Kjsl.js";import"./select-C7CmHxcC.js";import"./AnalysisAnimation-DGwhNpA-.js";import"./___vite-browser-external_commonjs-proxy-CwsIZm4V.js";const S=j,k=v,D=o.forwardRef(({className:a,...t},s)=>e.jsx(C,{ref:s,className:l("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t}));D.displayName=C.displayName;const z=o.forwardRef(({className:t,children:s,...r},o)=>e.jsxs(k,{children:[e.jsx(D,{}),e.jsxs(b,{ref:o,className:l("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[s,e.jsxs(N,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(a,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));z.displayName=b.displayName;const _=({className:a,...t})=>e.jsx("div",{className:l("flex flex-col space-y-1.5 text-center sm:text-left",a),...t});_.displayName="DialogHeader";const O=({className:a,...t})=>e.jsx("div",{className:l("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t});O.displayName="DialogFooter";const R=o.forwardRef(({className:a,...t},s)=>e.jsx(y,{ref:s,className:l("text-lg font-semibold leading-none tracking-tight",a),...t}));R.displayName=y.displayName;const I=o.forwardRef(({className:a,...t},s)=>e.jsx(w,{ref:s,className:l("text-sm text-muted-foreground",a),...t}));I.displayName=w.displayName;const V=()=>{const{id:a}=i(),{getCV:l,saveCV:j,updateCV:v}=c(),b=n(),N=d(),{toast:y}=m(),{t:w}=p(),[C,k]=o.useState(""),[D,V]=o.useState(!1),[F,P]=o.useState(null),[J,q]=o.useState(!1);o.useEffect(()=>{var e;if("new"===a)if(q(!0),V(!0),null==(e=N.state)?void 0:e.uploadedData){const e=N.state.uploadedData;localStorage.setItem("cv_data",JSON.stringify(e)),P(e),b(N.pathname,{replace:!0,state:{}})}else{const e=localStorage.getItem("cv_data");if(e)try{P(JSON.parse(e))}catch(t){}}else if(a){const e=l(a);e?(P(e.data),k(e.name),localStorage.setItem("cv_data",JSON.stringify(e.data))):(y({title:w("home.partner.builder.cvNotFound"),description:w("home.partner.builder.cvNotFoundDesc"),variant:"destructive"}),b("/partner/cvs"))}},[a,l,b,y]);const A=()=>{C.trim()&&V(!1)};return e.jsx(f,{children:e.jsxs("div",{className:"relative",children:[e.jsx(t.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"sticky top-0 z-40 bg-background/95 backdrop-blur-xl border-b border-border shadow-sm",children:e.jsxs("div",{className:"px-8 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>b("/partner/cvs"),className:"text-muted-foreground hover:text-foreground",children:[e.jsx(s,{className:"w-4 h-4 mr-2"}),w("home.partner.builder.back")]}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:C||w("home.partner.builder.newCV")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:w(J||"new"===a?"home.partner.builder.creating":"home.partner.builder.editing")})]})]}),e.jsxs(u,{onClick:()=>{if(!C.trim())return y({title:w("home.partner.builder.nameRequired"),description:w("home.partner.builder.nameRequiredDesc"),variant:"destructive"}),void V(!0);const e=localStorage.getItem("cv_data");if(!e)return void y({title:w("home.partner.builder.error"),description:w("home.partner.builder.noDataToSave"),variant:"destructive"});const t=JSON.parse(e);if(J||"new"===a){const e=localStorage.getItem("language")||"fr";j({name:C,language:e,data:t}),y({title:w("home.partner.builder.cvCreated"),description:w("home.partner.builder.cvCreatedDesc")}),b("/partner/cvs")}else a&&(v(a,t),y({title:w("home.partner.builder.cvUpdated"),description:w("home.partner.builder.cvUpdatedDesc")}))},className:"bg-gradient-to-r from-primary to-blue-bright hover:shadow-lg hover:shadow-primary/50 transition-all",children:[e.jsx(r,{className:"w-4 h-4 mr-2"}),w("home.partner.builder.save")]})]})}),e.jsx("div",{className:"bg-background",children:e.jsx(h,{})}),e.jsx(S,{open:D,onOpenChange:V,children:e.jsxs(z,{children:[e.jsxs(_,{children:[e.jsx(R,{children:w("home.partner.builder.nameYourCV")}),e.jsx(I,{children:w("home.partner.builder.nameYourCVDesc")})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"cvName",children:w("home.partner.builder.cvName")}),e.jsx(x,{id:"cvName",placeholder:w("home.partner.builder.cvNamePlaceholder"),value:C,onChange:e=>k(e.target.value),onKeyDown:e=>{"Enter"===e.key&&A()},autoFocus:!0})]})}),e.jsxs(O,{children:[e.jsx(u,{variant:"outline",onClick:()=>b("/partner/cvs"),children:w("home.partner.builder.cancel")}),e.jsx(u,{onClick:A,disabled:!C.trim(),children:w("home.partner.builder.continue")})]})]})})]})})};export{V as default};
