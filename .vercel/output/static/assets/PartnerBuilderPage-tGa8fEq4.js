import{j as e,X as F,m as T,e as E,z as L}from"./ui-vendor-DmnzVvUC.js";import{r as n,f as B,u as J,e as _}from"./react-vendor-CGj_E3sL.js";import{h as m,b as q,c as A,a as H,B as u}from"./index-BEFO6H8i.js";import{P as U}from"./PartnerLayout-D4MA7B5L.js";import Y from"./BuilderPage-5wwLlK4A.js";import{I as K}from"./input-CGlKybwf.js";import{L as X}from"./label-LVuxW4O_.js";import{R as G,P as M,C as j,a as Q,T as y,D,O as w}from"./pdfGenerator-CnE0ZIX9.js";import"./LanguageSwitcher-DYMuky2f.js";import"./index-DlQgVf6T.js";import"./tslib.es6-CiBE_y40.js";import"./useSEO-CSB_9WCC.js";import"./select-C43do_PO.js";import"./AnalysisAnimation-k7GG13EW.js";import"./___vite-browser-external_commonjs-proxy-BrL237SC.js";const W=G,Z=M,C=n.forwardRef(({className:t,...s},o)=>e.jsx(w,{ref:o,className:m("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));C.displayName=w.displayName;const S=n.forwardRef(({className:t,children:s,...o},f)=>e.jsxs(Z,{children:[e.jsx(C,{}),e.jsxs(j,{ref:f,className:m("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...o,children:[s,e.jsxs(Q,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));S.displayName=j.displayName;const k=({className:t,...s})=>e.jsx("div",{className:m("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});k.displayName="DialogHeader";const P=({className:t,...s})=>e.jsx("div",{className:m("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});P.displayName="DialogFooter";const V=n.forwardRef(({className:t,...s},o)=>e.jsx(y,{ref:o,className:m("text-lg font-semibold leading-none tracking-tight",t),...s}));V.displayName=y.displayName;const R=n.forwardRef(({className:t,...s},o)=>e.jsx(D,{ref:o,className:m("text-sm text-muted-foreground",t),...s}));R.displayName=D.displayName;const he=()=>{const{id:t}=B(),{getCV:s,saveCV:o,updateCV:f}=q(),l=J(),h=_(),{toast:d}=A(),{t:a}=H(),[c,v]=n.useState(""),[I,p]=n.useState(!1),[$,g]=n.useState(null),[b,O]=n.useState(!1);n.useEffect(()=>{var i;if(t==="new")if(O(!0),p(!0),(i=h.state)!=null&&i.uploadedData){const r=h.state.uploadedData;localStorage.setItem("cv_data",JSON.stringify(r)),g(r),l(h.pathname,{replace:!0,state:{}})}else{const r=localStorage.getItem("cv_data");if(r)try{g(JSON.parse(r))}catch(x){console.error("Error parsing uploaded CV data:",x)}}else if(t){const r=s(t);r?(g(r.data),v(r.name),localStorage.setItem("cv_data",JSON.stringify(r.data))):(d({title:a("home.partner.builder.cvNotFound"),description:a("home.partner.builder.cvNotFoundDesc"),variant:"destructive"}),l("/partner/cvs"))}},[t,s,l,d]);const z=()=>{if(!c.trim()){d({title:a("home.partner.builder.nameRequired"),description:a("home.partner.builder.nameRequiredDesc"),variant:"destructive"}),p(!0);return}const i=localStorage.getItem("cv_data");if(!i){d({title:a("home.partner.builder.error"),description:a("home.partner.builder.noDataToSave"),variant:"destructive"});return}const r=JSON.parse(i);if(b||t==="new"){const x=localStorage.getItem("language")||"fr";o({name:c,language:x,data:r}),d({title:a("home.partner.builder.cvCreated"),description:a("home.partner.builder.cvCreatedDesc")}),l("/partner/cvs")}else t&&(f(t,r),d({title:a("home.partner.builder.cvUpdated"),description:a("home.partner.builder.cvUpdatedDesc")}))},N=()=>{c.trim()&&p(!1)};return e.jsx(U,{children:e.jsxs("div",{className:"relative",children:[e.jsx(T.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"sticky top-0 z-40 bg-background/95 backdrop-blur-xl border-b border-border shadow-sm",children:e.jsxs("div",{className:"px-8 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>l("/partner/cvs"),className:"text-muted-foreground hover:text-foreground",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),a("home.partner.builder.back")]}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:c||a("home.partner.builder.newCV")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a(b||t==="new"?"home.partner.builder.creating":"home.partner.builder.editing")})]})]}),e.jsxs(u,{onClick:z,className:"bg-gradient-to-r from-primary to-blue-bright hover:shadow-lg hover:shadow-primary/50 transition-all",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),a("home.partner.builder.save")]})]})}),e.jsx("div",{className:"bg-background",children:e.jsx(Y,{})}),e.jsx(W,{open:I,onOpenChange:p,children:e.jsxs(S,{children:[e.jsxs(k,{children:[e.jsx(V,{children:a("home.partner.builder.nameYourCV")}),e.jsx(R,{children:a("home.partner.builder.nameYourCVDesc")})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"cvName",children:a("home.partner.builder.cvName")}),e.jsx(K,{id:"cvName",placeholder:a("home.partner.builder.cvNamePlaceholder"),value:c,onChange:i=>v(i.target.value),onKeyDown:i=>{i.key==="Enter"&&N()},autoFocus:!0})]})}),e.jsxs(P,{children:[e.jsx(u,{variant:"outline",onClick:()=>l("/partner/cvs"),children:a("home.partner.builder.cancel")}),e.jsx(u,{onClick:N,disabled:!c.trim(),children:a("home.partner.builder.continue")})]})]})})]})})};export{he as default};
