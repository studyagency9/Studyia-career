import{j as e,f as n,T as r}from"./ui-vendor-CNk_zvnd.js";import{r as t,u as a}from"./react-vendor-BjqsZnKR.js";import{u as s,p as o}from"./pdf-BuvusFHH.js";import{a as i,t as l}from"./index-CcJ1OsnK.js";import{A as c}from"./AnalysisAnimation-DGwhNpA-.js";import{P as u}from"./PartnerLayout-CyuO4Ior.js";import"./tslib.es6-JUDyx5pz.js";import"./___vite-browser-external_commonjs-proxy-CwsIZm4V.js";import"./LanguageSwitcher-4nTyKiJX.js";import"./index-D3__vsal.js";o.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${o.version}/pdf.worker.min.js`;const d=()=>{const[d,p]=t.useState(!1),[m,f]=t.useState(null),x=a(),{t:h}=i(),{getRootProps:N,getInputProps:T,isDragActive:j}=s({onDrop:async e=>{var n;const r=e[0];if(!r)return;p(!0),f(null);try{let e="";if("application/pdf"!==r.type)throw new Error(h("home.partner.upload.docxNotSupported"));e=await(async e=>{const n=await e.arrayBuffer(),r=await o.getDocument(n).promise;let t="";for(let a=1;a<=r.numPages;a++){const e=await r.getPage(a);t+=(await e.getTextContent()).items.map(e=>"str"in e?e.str:"").join(" ")+"\n"}return t})(r);const t="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",a=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json","HTTP-Referer":"http://localhost:8080/","X-Title":"Studyia Career CV Builder"},body:JSON.stringify({model:"meta-llama/llama-3.3-70b-instruct:free",messages:[{role:"system",content:'Tu es une IA spÃ©cialisÃ©e dans l\'analyse, l\'extraction et la structuration de CV pour une application de carriÃ¨re appelÃ©e Studyia Career.\n\nTon rÃ´le est de transformer le TEXTE BRUT d\'un CV (issu d\'un PDF, DOCX ou copier-coller) en un objet JSON structurÃ©, propre et exploitable par une application web.\n\nTu agis comme un moteur de parsing intelligent, rigoureux et fiable, adaptÃ© au marchÃ© francophone.\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nðŸŽ¯ OBJECTIF PRINCIPAL\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nÃ€ partir du texte brut d\'un CV fourni en entrÃ©e :\n- Identifier\n- Extraire\n- Classer\n- HiÃ©rarchiser\nles informations du CV\nET\n- Retourner UNIQUEMENT un objet JSON valide\n- Respecter STRICTEMENT la structure dÃ©finie ci-dessous\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nðŸ“¦ FORMAT DE SORTIE OBLIGATOIRE (JSON UNIQUEMENT)\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nTu dois retourner EXACTEMENT cette structure JSON :\n\n{\n  "personalInfo": {\n    "firstName": "",\n    "lastName": "",\n    "email": "",\n    "phone": "",\n    "city": "",\n    "country": "",\n    "summary": ""\n  },\n  "targetJob": "",\n  "experiences": [\n    {\n      "title": "",\n      "company": "",\n      "location": "",\n      "startDate": "",\n      "endDate": "",\n      "description": ""\n    }\n  ],\n  "education": [\n    {\n      "degree": "",\n      "school": "",\n      "location": "",\n      "startDate": "",\n      "endDate": "",\n      "description": ""\n    }\n  ],\n  "skills": []\n}\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nðŸ“Œ RÃˆGLES STRICTES (TRÃˆS IMPORTANT)\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n1. âš ï¸ TA RÃ‰PONSE DOIT ÃŠTRE UNIQUEMENT DU JSON\n   - Aucun texte\n   - Aucune explication\n   - Aucun commentaire\n   - Aucun markdown\n\n2. ðŸ” DONNÃ‰ES MANQUANTES\n   - Si une information n\'est PAS trouvÃ©e dans le CV :\n     - utiliser une chaÃ®ne vide "" pour les champs texte\n     - utiliser un tableau vide [] pour les listes\n\n3. ðŸ§  INTERPRÃ‰TATION INTELLIGENTE\n   - Tu dois reconnaÃ®tre :\n     - diffÃ©rentes langues (principalement franÃ§ais)\n     - diffÃ©rentes structures de CV\n     - diffÃ©rentes appellations de sections :\n       - "ExpÃ©rience professionnelle", "Parcours", "Work Experience"\n       - "Formation", "Ã‰ducation", "Studies"\n       - "CompÃ©tences", "Skills", "Expertise"\n   - Tu dois regrouper logiquement les informations mÃªme si le CV est mal structurÃ©\n\n4. ðŸ“… DATES\n   - Les formats de dates sont FLEXIBLES :\n     - "2022"\n     - "01/2021 - 06/2023"\n     - "Janvier 2020 â€“ PrÃ©sent"\n   - Ne reformate pas agressivement\n   - Recopie la valeur telle qu\'elle apparaÃ®t, de maniÃ¨re propre et lisible\n\n5. ðŸ§¾ EXPÃ‰RIENCES & FORMATION\n   - Chaque expÃ©rience ou formation doit Ãªtre un objet distinct\n   - La description doit contenir les missions, responsabilitÃ©s ou dÃ©tails disponibles. SÃ©pare chaque mission ou point par un retour Ã  la ligne (\n).\n   - Ne fusionne pas plusieurs expÃ©riences en une seule\n\n6. ðŸŽ¯ POSTE CIBLÃ‰ (targetJob)\n   - Si un poste recherchÃ© est clairement mentionnÃ© (ex: "DÃ©veloppeur Web", "Data Analyst"), renseigne-le\n   - Sinon, retourne une chaÃ®ne vide ""\n\n7. ðŸ§¼ NETTOYAGE\n   - Supprime les doublons Ã©vidents\n   - Nettoie les caractÃ¨res inutiles\n   - Ne rÃ©Ã©cris pas le contenu, ne fais pas d\'analyse sÃ©mantique avancÃ©e\n   - Ton rÃ´le est STRUCTURANT, pas CONSEILLER\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nðŸ›‘ INTERDICTIONS ABSOLUES\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n- Ne jamais inventer une information\n- Ne jamais remplir un champ avec une supposition\n- Ne jamais ajouter de champs supplÃ©mentaires\n- Ne jamais modifier la structure JSON\n- Ne jamais parler Ã  l\'utilisateur\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nâœ… RÃ‰SULTAT ATTENDU\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nUn JSON propre, cohÃ©rent, prÃªt Ã  Ãªtre injectÃ© directement dans l\'Ã©diteur de CV Studyia Career pour :\n- affichage\n- modification\n- reformatage\n- analyse IA ultÃ©rieure'},{role:"user",content:`Here is the CV text to analyze:\n\n${e}`}]})});if(!a.ok){const e=await a.json();throw new Error((null==(n=e.error)?void 0:n.message)||h("home.partner.upload.analysisError"))}const s=(await a.json()).choices[0].message.content,i=s.indexOf("{"),c=s.lastIndexOf("}")+1;if(-1===i||0===c)throw new Error(h("home.partner.upload.noJsonFound"));const u=s.substring(i,c),d=JSON.parse(u);l({title:h("home.partner.upload.analysisSuccess"),description:h("home.partner.upload.analysisSuccessDesc")}),(e=>{localStorage.setItem("cv_data",JSON.stringify(e)),x("/partner/builder/new",{state:{uploadedData:e}})})(d)}catch(t){const e=t instanceof Error?t.message:h("home.partner.upload.genericError");f(e),l({title:h("home.partner.upload.analysisErrorTitle"),description:e,variant:"destructive"})}finally{p(!1)}},accept:{"application/pdf":[".pdf"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"]},maxFiles:1});return e.jsx(u,{children:e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-8",children:e.jsx("div",{className:"w-full max-w-2xl",children:e.jsxs("div",{className:"bg-background p-8 rounded-xl shadow-lg border border-border",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-3",children:h("home.partner.upload.title")}),e.jsx("p",{className:"text-muted-foreground",children:h("home.partner.upload.subtitle")})]}),e.jsxs("div",{...N(),className:"p-10 border-2 border-dashed rounded-xl text-center cursor-pointer transition-colors\n                "+(j?"border-primary bg-primary/10":"border-border hover:border-primary/50"),children:[e.jsx("input",{...T()}),d?e.jsxs("div",{className:"flex flex-col items-center justify-center text-primary",children:[e.jsx(c,{}),e.jsx("p",{className:"font-semibold -mt-8",children:h("home.partner.upload.analyzing")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h("home.partner.upload.pleaseWait")})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center text-muted-foreground",children:[e.jsx(n,{className:"w-12 h-12 mb-4"}),e.jsx("p",{className:"font-semibold",children:h("home.partner.upload.dragDrop")}),e.jsx("p",{className:"text-sm",children:h("home.partner.upload.orClick")})]})]}),m&&e.jsxs("div",{className:"mt-4 p-3 bg-destructive/10 border border-destructive/50 text-destructive-foreground rounded-lg flex items-center",children:[e.jsx(r,{className:"w-5 h-5 mr-3 flex-shrink-0"}),e.jsx("p",{className:"text-sm",children:m})]})]})})})})};export{d as default};
